var $jscomp=$jscomp||{};$jscomp.scope={},$jscomp.checkStringArgs=function(e,n,t){if(null==e)throw new TypeError("The 'this' value for String.prototype."+t+" must not be null or undefined");if(n instanceof RegExp)throw new TypeError("First argument to String.prototype."+t+" must not be a regular expression");return e+""},$jscomp.ASSUME_ES5=!1,$jscomp.ASSUME_NO_NATIVE_MAP=!1,$jscomp.ASSUME_NO_NATIVE_SET=!1,$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,n,t){e!=Array.prototype&&e!=Object.prototype&&(e[n]=t.value)},$jscomp.getGlobal=function(e){return"undefined"!=typeof window&&window===e?e:"undefined"!=typeof global&&null!=global?global:e},$jscomp.global=$jscomp.getGlobal(this),$jscomp.polyfill=function(e,n,t,i){if(n){for(t=$jscomp.global,e=e.split("."),i=0;i<e.length-1;i++){var r=e[i];r in t||(t[r]={}),t=t[r]}(n=n(i=t[e=e[e.length-1]]))!=i&&null!=n&&$jscomp.defineProperty(t,e,{configurable:!0,writable:!0,value:n})}},$jscomp.polyfill("String.prototype.startsWith",(function(e){return e||function(e,n){var t=$jscomp.checkStringArgs(this,e,"startsWith");e+="";var i=t.length,r=e.length;n=Math.max(0,Math.min(0|n,t.length));for(var o=0;o<r&&n<i;)if(t[n++]!=e[o++])return!1;return o>=r}}),"es6","es3");var BrowserPrint=function(){function e(e,n){var t=new XMLHttpRequest;return"withCredentials"in t?t.open(e,n,!0):"undefined"!=typeof XDomainRequest?(t=new XDomainRequest).open(e,n):t=null,t}function n(e,n,t,r){return void 0!==e&&(void 0===t&&(t=e.sendFinishedCallback),void 0===r&&(r=e.sendErrorCallback)),i(n,t,r)}function t(e,n,t){return void 0===n&&(n=r.defaultSuccessCallback),void 0===t&&(t=r.defaultErrorCallback),i(e,n,t)}function i(e,n,t){return e.onreadystatechange=function(){e.readyState===XMLHttpRequest.DONE&&200===e.status?""===e.responseType?n(e.responseText):n(e.response):e.readyState===XMLHttpRequest.DONE&&(t?t(e.response):console.log("error occurred with no errorCallback set."))},e}var r={},o={},s=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);navigator.userAgent.indexOf("Trident/7.0");var a="http://127.0.0.1:9100/";return s&&"https:"===location.protocol&&(a="https://127.0.0.1:9101/"),r.Device=function(o){var s=this;this.name=o.name,this.deviceType=o.deviceType,this.connection=o.connection,this.uid=o.uid,this.version=2,this.provider=o.provider,this.manufacturer=o.manufacturer,this.readRetries="bluetooth"===this.connection?1:0,this.sendErrorCallback=function(e){},this.sendFinishedCallback=function(e){},this.readErrorCallback=function(e){},this.readFinishedCallback=function(e){},this.send=function(t,i,r){var o=e("POST",a+"write");o&&(n(s,o,i,r),o.send(JSON.stringify({device:{name:this.name,uid:this.uid,connection:this.connection,deviceType:this.deviceType,version:this.version,provider:this.provider,manufacturer:this.manufacturer},data:t})))},this.sendUrl=function(t,i,r,o){var c=e("POST",a+"write");c&&(n(s,c,i,r),t={device:{name:this.name,uid:this.uid,connection:this.connection,deviceType:this.deviceType,version:this.version,provider:this.provider,manufacturer:this.manufacturer},url:t},null!=o&&null!=o&&(t.options=o),c.send(JSON.stringify(t)))},this.sendFile=function(n,i,o){if("string"==typeof n)r.loadFileFromUrl(n,(function(e){s.sendFile(e,i,o)}),o);else{var c=e("POST",a+"write");if(c){c.responseType="text",t(c,i,o);var u=new FormData,l={};l.device=s,u.append("json",JSON.stringify(l)),u.append("blob",n),c.send(u)}}},this.convertAndSendFile=function(e,n,t,i){i||(i={}),i.action||(i.action="print"),r.convert(e,this,i,n,t)},this.read=function(n,t){var r=e("POST",a+"read");r&&(void 0!==s&&(void 0===n&&(n=s.readFinishedCallback),void 0===t&&(t=s.readErrorCallback)),i(r,n,t),r.send(JSON.stringify({device:{name:this.name,uid:this.uid,connection:this.connection,deviceType:this.deviceType,version:this.version,provider:this.provider,manufacturer:this.manufacturer}})))},this.readUntilStringReceived=function(e,n,t,i,r){r||(r=""),void 0===i&&(i=this.readRetries),n=function(n,t,i,r,o){return function(s){if(s&&0!==s.length)r=0;else if(0>=r)return void t(o);s=o+s,""!==e&&-1<s.indexOf(e)?t(s):n.readUntilStringReceived(e,t,i,r-1,s)}}(this,n,t,i,r),this.read(n,t)},this.readAllAvailable=function(e,n,t){this.readUntilStringReceived("",e,n,t)},this.sendThenRead=function(e,n,t){this.send(e,function(e){return function(){e.read(n,t)}}(this),t)},this.sendThenReadUntilStringReceived=function(e,n,t,i,r){this.send(e,function(e){return function(){e.readUntilStringReceived(n,t,i,r)}}(this),i)},this.sendThenReadAllAvailable=function(e,n,t,i){this.send(e,function(e){return function(){e.readUntilStringReceived("",n,t,i)}}(this),t)}},r.defaultSuccessCallback=function(){},r.defaultErrorCallback=function(){},r.ApplicationConfiguration=function(){this.application={version:"1.2.0.3",build_number:3,api_level:2,platform:"",supportedConversions:{}}},r.getLocalDevices=function(n,i,o){var s=e("GET",a+"available");s&&(finishedFunction=function(e){for(var t in response=e,response=JSON.parse(response),response)if(response.hasOwnProperty(t)&&response[t].constructor===Array)for(arr=response[t],e=0;e<arr.length;++e)arr[e]=new r.Device(arr[e]);void 0===o?n(response):(response.hasOwnProperty(o)||(response[o]=[]),n(response[o]))},t(s,finishedFunction,i),s.send())},r.getDefaultDevice=function(n,i,o){var s="default";void 0!==n&&null!=n&&(s=s+"?type="+n),(n=e("GET",a+s))&&(finishedFunction=function(e){response=e,""===response?i(null):(response=JSON.parse(response),e=new r.Device(response),i(e))},(n=t(n,finishedFunction,o)).send())},r.getApplicationConfiguration=function(n,i){var r=e("GET",a+"config");r&&(finishedFunction=function(e){response=e,""===response?n(null):(response=JSON.parse(response),n(response))},t(r,finishedFunction,i),r.send())},r.readOnInterval=function(e,n,t){void 0!==t&&0!==t||(t=1),readFunc=function(){e.read((function(i){n(i),o[e]=setTimeout(readFunc,t)}),(function(n){o[e]=setTimeout(readFunc,t)}))},o[e]=setTimeout(readFunc,t)},r.stopReadOnInterval=function(e){o[e]&&clearTimeout(o[e])},r.bindFieldToReadData=function(e,n,t,i){r.readOnInterval(e,(function(e){""!==e&&(n.value=e,void 0!==i&&null!=i&&i())}),t)},r.loadFileFromUrl=function(n,i,r){request=e("get",n),console.log("ResponseType: "+request.responseType),request.responseType="blob",t(request,i,r),request.send()},r.convert=function(n,i,o,s,c){if(n)if("string"==typeof n)r.loadFileFromUrl(n,(function(e){o.fromFormat||(o.fromFormat=n.substring(n.length-3)),r.convert(e,i,o,s,c)}),c);else{var u=e("POST",a+"convert");if(n.type&&(n.type.startsWith("image/")||n.type.startsWith("application/"))&&(o.fromFormat=n.type.toLowerCase().replace("image/","").replace("application/","").replace("x-ms-","")),u){u.responseType="text";var l=void 0;null!=s&&(l=function(e){s(JSON.parse(e))}),t(u,l,c),l=new FormData;var p={};null!=o&&void 0!==o&&(p.options=o),i&&(p.device=i),l.append("json",JSON.stringify(p)),l.append("blob",n),u.send(l)}}else c?c("Resource not specified"):r.defaultErrorCallback("Resource not specified")},r.scanImage=function(n,i,o,s){if(n)if("string"==typeof n)r.loadFileFromUrl(n,(function(e){i.format||(i.format=n.substring(n.length-3)),r.scanImage(e,i,o,s)}),s);else{var c=e("POST",a+"convert/scan");if(n.type&&(n.type.startsWith("image/")||n.type.startsWith("application/"))&&(i.format=n.type.toLowerCase().replace("image/","").replace("application/","").replace("x-ms-","")),c){c.responseType="text";var u=void 0;null!=o&&(u=function(e){o(JSON.parse(e))}),t(c,u,s),u=new FormData;var l={};l.options=i,u.append("json",JSON.stringify(l)),u.append("blob",n),c.send(u)}}else s?s("Resource not specified"):r.defaultErrorCallback("Resource not specified")},r}();