var $jscomp=$jscomp||{};function dbg(e){}$jscomp.scope={},$jscomp.ASSUME_ES5=!1,$jscomp.ASSUME_NO_NATIVE_MAP=!1,$jscomp.ASSUME_NO_NATIVE_SET=!1,$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){e!=Array.prototype&&e!=Object.prototype&&(e[t]=n.value)},$jscomp.getGlobal=function(e){return"undefined"!=typeof window&&window===e?e:"undefined"!=typeof global&&null!=global?global:e},$jscomp.global=$jscomp.getGlobal(this),$jscomp.SYMBOL_PREFIX="jscomp_symbol_",$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){},$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)},$jscomp.Symbol=function(){var e=0;return function(t){return $jscomp.SYMBOL_PREFIX+(t||"")+e++}}(),$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var e=$jscomp.global.Symbol.iterator;e||(e=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator")),"function"!=typeof Array.prototype[e]&&$jscomp.defineProperty(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}}),$jscomp.initSymbolIterator=function(){}},$jscomp.arrayIterator=function(e){var t=0;return $jscomp.iteratorPrototype((function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}))},$jscomp.iteratorPrototype=function(e){return $jscomp.initSymbolIterator(),(e={next:e})[$jscomp.global.Symbol.iterator]=function(){return this},e},$jscomp.makeIterator=function(e){$jscomp.initSymbolIterator();var t=e[Symbol.iterator];return t?t.call(e):$jscomp.arrayIterator(e)},$jscomp.polyfill=function(e,t,n,i){if(t){for(n=$jscomp.global,e=e.split("."),i=0;i<e.length-1;i++){var s=e[i];s in n||(n[s]={}),n=n[s]}(t=t(i=n[e=e[e.length-1]]))!=i&&null!=t&&$jscomp.defineProperty(n,e,{configurable:!0,writable:!0,value:t})}},$jscomp.FORCE_POLYFILL_PROMISE=!1,$jscomp.polyfill("Promise",(function(e){function t(){this.batch_=null}function n(e){return e instanceof s?e:new s((function(t,n){t(e)}))}if(e&&!$jscomp.FORCE_POLYFILL_PROMISE)return e;t.prototype.asyncExecute=function(e){return null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_()),this.batch_.push(e),this},t.prototype.asyncExecuteBatch_=function(){var e=this;this.asyncExecuteFunction((function(){e.executeBatch_()}))};var i=$jscomp.global.setTimeout;t.prototype.asyncExecuteFunction=function(e){i(e,0)},t.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var e=this.batch_;this.batch_=[];for(var t=0;t<e.length;++t){var n=e[t];delete e[t];try{n()}catch(e){this.asyncThrow_(e)}}}this.batch_=null},t.prototype.asyncThrow_=function(e){this.asyncExecuteFunction((function(){throw e}))};var s=function(e){this.state_=0,this.result_=void 0,this.onSettledCallbacks_=[];var t=this.createResolveAndReject_();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}};s.prototype.createResolveAndReject_=function(){function e(e){return function(i){n||(n=!0,e.call(t,i))}}var t=this,n=!1;return{resolve:e(this.resolveTo_),reject:e(this.reject_)}},s.prototype.resolveTo_=function(e){if(e===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof s)this.settleSameAsPromise_(e);else{e:switch(typeof e){case"object":var t=null!=e;break e;case"function":t=!0;break e;default:t=!1}t?this.resolveToNonPromiseObj_(e):this.fulfill_(e)}},s.prototype.resolveToNonPromiseObj_=function(e){var t=void 0;try{t=e.then}catch(e){return void this.reject_(e)}"function"==typeof t?this.settleSameAsThenable_(t,e):this.fulfill_(e)},s.prototype.reject_=function(e){this.settle_(2,e)},s.prototype.fulfill_=function(e){this.settle_(1,e)},s.prototype.settle_=function(e,t){if(0!=this.state_)throw Error("Cannot settle("+e+", "+t|"): Promise already settled in state"+this.state_);this.state_=e,this.result_=t,this.executeOnSettledCallbacks_()},s.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var e=this.onSettledCallbacks_,t=0;t<e.length;++t)e[t].call(),e[t]=null;this.onSettledCallbacks_=null}};var o=new t;return s.prototype.settleSameAsPromise_=function(e){var t=this.createResolveAndReject_();e.callWhenSettled_(t.resolve,t.reject)},s.prototype.settleSameAsThenable_=function(e,t){var n=this.createResolveAndReject_();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},s.prototype.then=function(e,t){function n(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(e){o(e)}}:t}var i,o,r=new s((function(e,t){i=e,o=t}));return this.callWhenSettled_(n(e,i),n(t,o)),r},s.prototype.catch=function(e){return this.then(void 0,e)},s.prototype.callWhenSettled_=function(e,t){function n(){switch(i.state_){case 1:e(i.result_);break;case 2:t(i.result_);break;default:throw Error("Unexpected state: "+i.state_)}}var i=this;null==this.onSettledCallbacks_?o.asyncExecute(n):this.onSettledCallbacks_.push((function(){o.asyncExecute(n)}))},s.resolve=n,s.reject=function(e){return new s((function(t,n){n(e)}))},s.race=function(e){return new s((function(t,i){for(var s=$jscomp.makeIterator(e),o=s.next();!o.done;o=s.next())n(o.value).callWhenSettled_(t,i)}))},s.all=function(e){var t=$jscomp.makeIterator(e),i=t.next();return i.done?n([]):new s((function(e,s){function o(t){return function(n){r[t]=n,0==--u&&e(r)}}var r=[],u=0;do{r.push(void 0),u++,n(i.value).callWhenSettled_(o(r.length-1),s),i=t.next()}while(!i.done)}))},s}),"es6","es3");var Zebra=function(){function e(e,t){if(t instanceof n.Printer.Status&&i[e.device.uid]){if(t.offline){if(e.errors++,e.errors<e.errorsForOffline)return}else e.errors=0;var s=i[e.device.uid].status,o=JSON.stringify(s);e.status=t,statusStr=JSON.stringify(t),statusStr!==o&&e.onchange(s,t)}}function t(e){return 2===e.charCodeAt(0)&&3===e.charCodeAt(e.length-1)||(dbg("Response did not contain proper control characters"),!1)}var n={},i={};return setInterval((function(){for(var t in i)i.hasOwnProperty(t)&&function(t){t.device.getStatus((function(n){e(t,n)}),(function(i){e(t,new n.Printer.Status(""))}))}(t=i[t])}),2e3),n.Printer=function(e){BrowserPrint.Device.call(this,e),n.Printer.Status=function(e){this.raw=e,this.isFlagSet=function(e){return"1"===this.raw.charAt(e)},this.offline=!1,e||(e=""),t(e=e.trim())?(this.offline=!1,this.paperOut=this.isFlagSet(5),this.paused=this.isFlagSet(7),this.headOpen=this.isFlagSet(43),this.ribbonOut=this.isFlagSet(45)):(this.offline=!0,this.ribbonOut=this.headOpen=this.paused=this.paperOut=!1),this.isPrinterReady=function(){return!(this.paperOut||this.paused||this.headOpen||this.ribbonOut||this.offline)},this.getMessage=function(){return this.isPrinterReady()?"Ready":this.offline?"Offline":this.paperOut?"Paper Out":this.headOpen?"Head Open":this.ribbonOut?"Ribbon Out":this.paused?"Paused":"Ready"}},n.Printer.Info=function(e){if(!e)throw"Invalid Response";if(this.raw=e,!t(e=e.trim()))throw"Invalid Response";e=e.split(","),this.model=e[0].substring(1),this.firmware=e[1]},n.Printer.Configuration=function(e){if(!e)throw"Invalid Response";if(this.raw=e=e.trim(),this.settings={},!t(e))throw"Invalid Response";e=(e=(e=e.replace(String.fromCharCode(2),"")).replace(String.fromCharCode(3),"")).split("\n");for(var n=0;n<e.length;++n){var i=e[n].trim(),s=i.substring(20);i=i.substring(0,20).trim(),this.settings[s]=i}this.darkness=parseFloat(this.settings.DARKNESS),this.printSpeed=parseInt(this.settings["PRINT SPEED"].replace("IPS","").trim()),this.printWidth=parseInt(this.settings["PRINT WIDTH"]),this.labelLength=parseInt(this.settings["LABEL LENGTH"]),this.firmwareVersion=this.settings.FIRMWARE.replace("<-","").trim(),this.linkOSVersion=this.settings.hasOwnProperty("LINK-OS VERSION")?this.settings["LINK-OS VERSION"]:"0"};var i=this;this.configuration=void 0,this.device_request_queue=[],this.clearRequestQueue=function(){var e=this.device_request_queue[0];this.device_request_queue=[],e&&e.started&&(this.device_request_queue[0]=e)},this.Request=function(e,t,n,s,o){this.type=e,this.command=t,this.received=n,this.success=s,this.error=function(e){return function(t){e(t),i.executeNextRequest()}}(o),this.execute=function(){this.started=!0,"info"==this.type||"config"==this.type||"status"==this.type?i.sendThenReadUntilStringReceived(this.command,String.fromCharCode(3),this.received,this.error):i.sendThenReadAllAvailable(this.command,this.received,this.error)}},this.executeNextRequest=function(){i.device_request_queue.shift(),i.executeRequest()},this.executeRequest=function(){dbg("Requests in queue: "+i.device_request_queue.length),0<i.device_request_queue.length&&(dbg("Executing next request..."),i.device_request_queue[0].execute())},this.queueRequest=function(e){dbg("Queueing request "+e.type+": "+i.device_request_queue.length),i.device_request_queue.push(e),1===i.device_request_queue.length&&e.execute()},this.onStatusResponse=function(e){dbg("received status response");var t=void 0;try{t=new n.Printer.Status(e)}catch(t){(e=i.device_request_queue[0]).error(t),i.executeNextRequest()}for(;0<i.device_request_queue.length;){if("status"!==(e=i.device_request_queue[0]).type){dbg("delivered to all status requests.");break}dbg("delivering status..."),e.success(t),i.device_request_queue.shift()}i.executeRequest()},this.onResponse=function(e,t){dbg("received info response");var n=i.device_request_queue[0];if(null!=t)try{e=new t(e)}catch(e){return n.error&&n.error(e),void i.executeNextRequest()}n.success&&n.success(e),i.executeNextRequest()},this.onSGDResponse=function(e){dbg("received sgd response"),i.onResponse(e)},this.onInfoResponse=function(e){dbg("received info response"),i.onResponse(e,n.Printer.Info)},this.onConfigurationResponse=function(e){dbg("received config response");try{i.configuration=new n.Printer.Configuration(e)}catch(e){}i.onResponse(e,n.Printer.Configuration)},this.setSGD=function(e,t,n,s){if(!n&&!s)return new Promise((function(n,s){i.setSGD(e,t,n,s)}));i.send('! U1 setvar "'+e+'" "'+t+'"\r\n',n,s)},this.getSGD=function(e,t,n){if(!t&&!n)return new Promise((function(t,n){i.getSGD(e,t,n)}));t=new this.Request("sgd",'! U1 getvar "'+e+'"\r\n',this.onSGDResponse,t,n),this.queueRequest(t)},this.setThenGetSGD=function(e,t,n,s){if(!n&&!s)return new Promise((function(n,s){i.setThenGetSGD(e,t,n,s)}));this.setSGD(e,t,(function(){i.getSGD(e,n,s)}),s)},this.getInfo=function(e,t){if(!e&&!t)return new Promise((function(e,t){i.getInfo(e,t)}));e=new this.Request("info","~hi\r\n",this.onInfoResponse,e,t),this.queueRequest(e)},this.getConfiguration=function(e,t){if(!e&&!t)return new Promise((function(e,t){i.getConfiguration(e,t)}));e=new this.Request("config","^XA^HH^XZ",this.onConfigurationResponse,e,t),this.queueRequest(e)},this.getStatus=function(e,t){if(!e&&!t)return new Promise((function(e,t){i.getStatus(e,t)}));e=new this.Request("status","~hs\r\n",this.onStatusResponse,e,t),i.queueRequest(e)},this.query=function(e,t,n){if(!t&&!n)return new Promise((function(t,n){i.query(e,t,n)}));t=new this.Request("",e,this.onResponse,t,n),this.queueRequest(t)},this.isPrinterReady=function(e,t){if(!e&&!t)return new Promise((function(e,t){i.isPrinterReady(e,t)}));this.getStatus().then((function(n){n.isPrinterReady()?e(n.getMessage()):t(n.getMessage())}))},this.printImageAsLabel=function(e,t,n,o){if(!n&&!o)return new Promise((function(n,s){i.printImageAsLabel(e,t,n,s)}));s().then((function(s){t.fitTo={width:s.printWidth,height:s.labelLength},t.action="print",BrowserPrint.convert(e,i,t,n,o)})).catch(o)},this.getConvertedResource=function(e,t,n,o){if(!n&&!o)return new Promise((function(n,s){i.getConvertedResource(e,t,n,s)}));s().then((function(s){t.action="return",BrowserPrint.convert(e,i,t,n,o)})).catch(o)},this.storeConvertedResource=function(e,t,n,o){if(!n&&!o)return new Promise((function(n,s){i.storeConvertedResource(e,t,n,s)}));s().then((function(s){t.action="store",BrowserPrint.convert(e,i,t,n,o)})).catch(o)};var s=function(){return new Promise((function(e,t){if(!i.configuration)return i.getConfiguration().then((function(e){return i.configuration=e,i.configuration})).catch((function(e){t(e)}));e(i.configuration)}))};this.configTimeout=function(){i.configuration||i.getConfiguration().then((function(e){return i.configuration=e})).catch((function(){setTimeout(i.configTimeout,1e3)}))},this.configTimeout()},n.watch=function(e,t,n){n||(n=2),i[e.uid]={device:e,status:"",onchange:t,errors:0,errorsForOffline:n}},n.stopWatching=function(e){delete i[e.uid]},n}();